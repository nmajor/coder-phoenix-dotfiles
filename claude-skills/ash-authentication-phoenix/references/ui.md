# Ash-Authentication-Phoenix - Ui

**Pages:** 5

---

## AshAuthentication.Phoenix.MagicSignInLive (ash_authentication_phoenix v2.12.1)

**URL:** https://hexdocs.pm/ash_authentication_phoenix/AshAuthentication.Phoenix.MagicSignInLive.html

**Contents:**
- AshAuthentication.Phoenix.MagicSignInLive (ash_authentication_phoenix v2.12.1)
- Overrides

A generic, white-label confirmation page.

This is used when require_interaction? is set to true on a confirmation strategy.

This component provides the following overrides:

See AshAuthentication.Phoenix.Overrides for more information.

Hex Package Hex Preview Search HexDocs

Built using ExDoc (v0.38.4) for the Elixir programming language

---

## AshAuthentication.Phoenix.Overrides.Default (ash_authentication_phoenix v2.12.1)

**URL:** https://hexdocs.pm/ash_authentication_phoenix/AshAuthentication.Phoenix.Overrides.Default.html

**Contents:**
- AshAuthentication.Phoenix.Overrides.Default (ash_authentication_phoenix v2.12.1)
- Summary
- Functions
- Functions
- overrides()

This is the default overrides for our component UI.

The CSS styles are based on TailwindCSS.

Hex Package Hex Preview Search HexDocs

Built using ExDoc (v0.38.4) for the Elixir programming language

---

## AshAuthentication.Phoenix.Overrides.DaisyUI (ash_authentication_phoenix v2.12.1)

**URL:** https://hexdocs.pm/ash_authentication_phoenix/AshAuthentication.Phoenix.Overrides.DaisyUI.html

**Contents:**
- AshAuthentication.Phoenix.Overrides.DaisyUI (ash_authentication_phoenix v2.12.1)
- Summary
- Functions
- Functions
- overrides()

This is the daisyUI overrides for our component UI. Copied from the AshAuthentication.Phoenix.Overrides.Default module with tweaks.

The CSS styles are based on daisyUI.

Hex Package Hex Preview Search HexDocs

Built using ExDoc (v0.38.4) for the Elixir programming language

---

## AshAuthentication.Phoenix.ConfirmLive (ash_authentication_phoenix v2.12.1)

**URL:** https://hexdocs.pm/ash_authentication_phoenix/AshAuthentication.Phoenix.ConfirmLive.html

**Contents:**
- AshAuthentication.Phoenix.ConfirmLive (ash_authentication_phoenix v2.12.1)
- Overrides

A generic, white-label confirmation page.

This is used when require_interaction? is set to true on a confirmation strategy.

This component provides the following overrides:

See AshAuthentication.Phoenix.Overrides for more information.

Hex Package Hex Preview Search HexDocs

Built using ExDoc (v0.38.4) for the Elixir programming language

---

## Building a password-change UI

**URL:** https://hexdocs.pm/ash_authentication_phoenix/password-change.html

**Contents:**
- Building a password-change UI
- LiveComponent
- Policies
- Using the LiveComponent
- Security Email Notification
- Field Policies
  - Load hashed_password in the form
  - Field Policy Bypass

AshAuthentication's Igniter task adds a :change_password action when you specify the password strategy, but AshAuthenticationPhoenix does not provide a component for this action, so you will need to either write your own, or use one provided by a component library that supports AshPhoenix. The main reason for this is that the password-change UI is usually not as separate from the rest of an application as sign-in, registration, and password-reset actions.

This is the :change_password action that we are starting with, generated by Igniter.

Most web applications that you have used likely had the UI for changing your password somewhere under your personal settings. We are going to do the same, and create a LiveComponent to contain our password-change UI, which we can then mount in a LiveView with the rest of the user settings.

Start by defining the module, and defining the template in the render/1 function.

This will produce a form with the usual three fields (current password, new password, and confirmation of new password, to guard against typographical errors), and a submit button. Now let's populate the @form assign.

update/2 is covered in the Phoenix.LiveComponent life-cycle documentation, so we won't go into it here. The private function assign_form/1 should look familiar if you have any forms for Ash resources in your application, but with a significant addition: the prepare_source option.

The attribute phx-target={@myself} on the form in our template ensures the submit event is received by the component, so the handle_event/3 function in this module is called, rather than the LiveView that mounts this component receiving the event.

Again, this should look familiar if you have any forms on your other application resources, but handle the success case a little differently here, calling the function passed by the parent LiveView via the on_saved attribute. This will make more sense when we use this component in a LiveView.

Since the password-change workflow is done entirely in our application code, the AshAuthentication policy bypass will not pass. We need to add a policy that allows a user to run the :change_password action on themselves.

Finally, let's use this component in our UI somewhere. Exactly where this belongs will depend on the wider UX of your application, so for the sake of example, let's assume that you already have a LiveView called LiveUserSettings in your application, where you want to add the password-change form.

For the on_s

*[Content truncated]*

**Examples:**

Example 1 (unknown):
```unknown
# lib/my_app/accounts/user.ex
    # ...
    update :change_password do
      require_atomic? false
      accept []
      argument :current_password, :string, sensitive?: true, allow_nil?: false

      argument :password, :string,
        sensitive?: true,
        allow_nil?: false,
        constraints: [min_length: 8]

      argument :password_confirmation, :string, sensitive?: true, allow_nil?: false

      validate confirm(:password, :password_confirmation)

      validate {AshAuthentication.Strategy.Password.PasswordValidation,
                strategy_name: :password, password_argument: :c
...
```

Example 2 (python):
```python
# lib/my_app_web/components/change_password_component.ex
defmodule MyAppWeb.ChangePasswordComponent do
  @moduledoc """
  LiveComponent for changing the current user's password.
  """
  use MyAppWeb, :live_component
  alias MyApp.Accounts.User

  @impl true
  def render(assigns) do
    ~H"""
    <div>
      <.simple_form
        for={@form}
        id="user-password-change-form"
        phx-target={@myself}
        phx-submit="save"
      >
        <.input field={@form[:current_password]} type="password" label="Current Password" />
        <.input field={@form[:password]} type="password" label
...
```

Example 3 (python):
```python
@impl true
  def update(assigns, socket) do
    {:ok,
     socket
     |> assign(assigns)
     |> assign_form()}
  end

  defp assign_form(%{assigns: %{current_user: user}} = socket) do
    form = AshPhoenix.Form.for_update(user, :change_password, as: "user", actor: user)
    assign(socket, form: to_form(form))
  end
```

Example 4 (javascript):
```javascript
@impl true
  def handle_event("save", %{"user" => user_params}, %{assigns: assigns} = socket) do
    case AshPhoenix.Form.submit(assigns.form, params: user_params) do
      {:ok, user} ->
        assigns.on_saved.()
        {:noreply, socket}

      {:error, form} ->
        {:noreply, assign(socket, form: form)}
    end
  end
```

---
