# Keep image defaults, then override/extend
source-file /etc/tmux.conf

# Default terminal for xterm.js in Coder web browser
set -g default-terminal "xterm-256color"
set -g default-shell /usr/bin/zsh
set -g default-command "/usr/bin/zsh -l"

# Core usability and persistence (unchanged for multi-device background runs like Claude Code)
set -g history-limit 100000
set -g renumber-windows on
set -g base-index 1
setw -g pane-base-index 1
set -g focus-events on
set -g escape-time 0
setw -g aggressive-resize on
set -g remain-on-exit on
set -g exit-empty off
set -g allow-passthrough on  # Web escapes (clipboard, etc.)

# DISABLE mouse by default: Lets iOS Safari/browser handle native touch scrolling
set -g mouse off

# Vi copy mode for manual scrolling/highlighting
setw -g mode-keys vi
set -g status-keys vi

# Touch-friendly copy in mode
bind-key -T copy-mode-vi v send-keys -X begin-selection
bind-key -T copy-mode-vi y send-keys -X copy-selection-and-cancel
bind-key -T copy-mode-vi Enter send-keys -X copy-selection-and-cancel

# Page up/down in copy mode
bind-key -T copy-mode-vi Pageup send-keys -X page-up
bind-key -T copy-mode-vi Pagedown send-keys -X page-down

# Pane splitting
bind | split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind '%'

# Reload
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# Toggle mouse
bind M set -g mouse \; display "Mouse: #{?mouse,ON (tmux handles touch),OFF (browser native scroll)}"

# Clipboard
set -g set-clipboard external

# STRONGER status bar: High-contrast colors, bold text, subtle glow for visibility on iPhone web (black bg, white/cyan fg)
# Always on, bottom position, updates frequently
set -g status on
set -g status-position bottom
set -g status-justify left
set -g status-style 'bg=black fg=white'  # Dark bg for contrast against terminal
set -g status-left '#[bg=black,fg=cyan,bold] #S '  # Session name in bold cyan on black
set -g status-left-length 30  # Wider left for iPhone landscape
set -g status-right '#[bg=black,fg=yellow] %H:%M %d/%m #[fg=green]|%a| '  # Time/date bold yellow, day in green
set -g status-right-length 30
set -g status-interval 5  # Update every 5s (smooth clock, responsive)
setw -g window-status-style 'bg=colour236,fg=brightwhite'  # Dim gray bg for inactive windows
setw -g window-status-current-style 'bg=cyan,fg=black,bold'  # Bright cyan bg, bold black text for current window (stands out)
setw -g window-status-format ' #I:#W '  # Simple inactive format
setw -g window-status-current-format ' #I:#W '  # Same for current, but styled bold
setw -g window-status-separator ' | '  # Clean separators
set -g pane-border-style 'fg=colour240'  # Gray pane borders for structure
set -g pane-active-border-style 'fg=cyan,bg=cyan'  # Cyan highlight for active pane (glow effect on touch)

# Mode indicators (e.g., copy mode shows stronger bar flash)
setw -g mode-style 'bg=cyan,fg=black,bold'  # Cyan bg in vi mode for easy spot

# Truecolor
set -ga terminal-overrides ',xterm-256color:Tc'